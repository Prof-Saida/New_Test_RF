<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Form Redirect</title>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzDsFWWOXHulrmICbNm2fyr0SJ5uDLPzq9GGJwC5PBQEuF479ooeQK_qjuCpnNricmk/exec";

/* USER ID */
let userId = localStorage.getItem("userId");
if (!userId) {
  userId = "U" + Math.random().toString(36).substr(2, 9);
  localStorage.setItem("userId", userId);
}

/* LAST TYPE */
let lastType = localStorage.getItem("lastType");

/* NEXT FORM */
let chosenType;
switch (lastType) {
  case "A": chosenType = "B"; break;
  case "B": chosenType = "C"; break;
  case "C": chosenType = "D"; break;
  case "D": chosenType = "E"; break;
  case "E": chosenType = "F"; break;
  default:  chosenType = "A";
}

/* SAVE STATE */
localStorage.setItem("lastType", chosenType);

/* FORMS */
const forms = {
  A: "https://forms.gle/f5SfhpjNyU2hNLTa6",
  B: "https://forms.gle/Bggr2miD7K5LBFiM6",
  C: "https://forms.gle/GQDMDCCJjFoJNL937",
  D: "https://forms.gle/bQUzKVw4qmMAFjY68",
  E: "https://forms.gle/bpWjeaE1uHdKBWBd9",
  F: "https://forms.gle/y9tb4aF5cbknNLSSA"
};

/* ðŸ”¥ RELIABLE LOGGING WITH FETCH */
fetch(
  SCRIPT_URL +
    "?formType=" + encodeURIComponent(chosenType) +
    "&userId=" + encodeURIComponent(userId),
  {
    method: "GET",
    keepalive: true
  }
);

/* REDIRECT */
window.location.href = forms[chosenType] + "?userId=" + userId;
</script>

</head>

<body style="font-family:Arial; text-align:center; padding:50px;">
  <p>Redirecting to form <strong id="t"></strong>â€¦</p>
  <script>
    document.getElementById("t").innerText = chosenType;
  </script>
</body>
</html>
